{% extends "app/base.html" %}
{% block title %} {{ object.cve_id }}の詳細 {% endblock %}
{% block content %}
<div class="dropdown float-right">
    <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown"
        aria-haspopup="true" aria-expanded="false">
        編集
    </button>
    <div class="dropdown-menu" aria-labelledby="dropdownMenu1">
        <a class="dropdown-item" href="{% url 'app:vul_update' object.pk %}">修正</a>
        <a class="dropdown-item" href="{% url 'app:vul_delete' object.pk %}">削除</a>
    </div>
</div>
<table class="table table-striped">
    <tbody>
        <tr>
            <th colspan="4">CVE ID</th>
        </tr>
        <tr>
            <td colspan="4">
                <a href="{{ object.url }}">
                    <h3>{{ object.cve_id }}</h3>
                </a>
            </td>
        </tr>
        <tr>
            <th colspan="4">Base Score(CVSS v3)</th>
        </tr>
        <tr>
            <td colspan="4">
                <h3>基本値:<span id="base_score">{{ object.base_score }}</span></h3>
                <ul>
                    <div class="float-left">
                        <li>攻撃元区分:{{ object.access_vector }}</li>
                        <li>攻撃条件の複雑さ:{{ object.access_complexity }}</li>
                        <li>必要な特権レベル:{{ object.privileges_required }}</li>
                        <li>ユーザ関与レベル:{{ object.user_interaction }}</li>
                    </div>
                    <div class="float-right">
                        <li>攻撃された際の他方面への影響範囲の広がり:{{ object.scope }}</li>
                        <li>情報漏えいの可能性:{{ object.confidentiality_impact }}</li>
                        <li>情報改ざんの可能性:{{ object.integrity_impact }}</li>
                        <li>業務停止の可能性:{{ object.availability_impact }}</li>
                    </div>
                </ul>
            </td>
        </tr>
        <tr>
            <th colspan="4">脆弱性のタイプ</th>
        </tr>
        <tr>
            <td colspan="4">{{ object.weakness_enumertation }}</td>
        </tr>
        <tr>
            <th colspan="4">概要</th>
        </tr>
        <tr>
            <td colspan="4">{{ object.overview }}</td>
        </tr>
        <tr>
            <th colspan="4">対策方法</th>
        </tr>
        <tr>
            <td colspan="4">{{ object.solution }}</td>
        </tr>
        <tr>
            <th colspan="4">ベンダ情報</th>
        </tr>
        <tr>
            <td colspan="4">{{ object.vendor_information }}</td>
        </tr>
        <tr>
            <th colspan="4">影響を受けるシステム</th>
        </tr>
        <tr>
            <td colspan="4">
                <ul class="list-inline">
                    {% for app in object.affected_app.all %}
                    <li class="list-inline-item">・{{ app }}</li>
                    {% endfor %}
                </ul>
            </td>
        </tr>
        <tr>
            <th>作成者</th>
            <th>作成日時</th>
            <th>更新者</th>
            <th>更新日時</th>
        </tr>
        <tr>
            <td>{{ object.creator }}</td>
            <td>{{ object.created_at }}</td>
            <td>{{ object.updater }}</td>
            <td>{{ object.updated_at }}</td>
        </tr>
    </tbody>
</table>
<script>
var baseScore = document.getElementById('base_score');
// CVSSのBase Score値によってSeverityを書き換え 
if (9.0 <= baseScore.innerHTML && baseScore.innerHTML <= 10.0 ) {
    baseScore.innerHTML = '{{ object.base_score }}<span id="cvss_severity" class="badge badge-danger">Critical</span>';
} else if (7.0 <= baseScore.innerHTML && baseScore.innerHTML <= 8.9) {
    baseScore.innerHTML = '{{ object.base_score }}<span id="cvss_severity" class="badge badge-warning">High</span>';
} else if (4.0 <= baseScore.innerHTML && baseScore.innerHTML <= 6.9) {
    baseScore.innerHTML = '{{ object.base_score }}<span id="cvss_severity" class="badge badge-warning">Medium</span>';
} else if (0.1 <= baseScore.innerHTML && baseScore.innerHTML <= 3.9) {
    baseScore.innerHTML = '{{ object.base_score }}<span id="cvss_severity" class="badge badge-warning">Low</span>';
} else {
    baseScore.innerHTML = '{{ object.base_score }}<span id="cvss_severity" class="badge badge-dark">None</span>';
}
</script>
{% endblock %}